<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../../">
  <title data-ice="title">src/redux/modules/catalog.test.js | API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-BACKEND_URL">BACKEND_URL</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">component</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ErrorPage">ErrorPage</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">component/AddMicroservice</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-AddForm">AddForm</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-AddMicroServiceForm">AddMicroServiceForm</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-validate">validate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-EditForm">EditForm</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-AddMicroserviceForm">AddMicroserviceForm</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-fieldHeading">fieldHeading</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-formFields">formFields</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-formFieldsData">formFieldsData</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">component/App</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-App">App</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">component/DetailView</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-DetailView">DetailView</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ServiceTable">ServiceTable</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">component/SearchBox</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-SearchBox">SearchBox</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">component/layout</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Header">Header</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-NavInstance">NavInstance</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">redux</div><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-appReducer">appReducer</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">utils</div><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-LoadingStates">LoadingStates</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-LoadingStatesValues">LoadingStatesValues</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/redux/modules/catalog.test.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import React from &apos;react&apos;;
import thunk from &apos;redux-thunk&apos;;
import configureMockStore from &apos;redux-mock-store&apos;;
import { createLogger } from &apos;redux-logger&apos;;
import { shallow } from &apos;enzyme&apos;;
import nock from &apos;nock&apos;;

import * as catalog from &apos;./catalog&apos;;
import catalogJSONData from &apos;json!/../../../fixtures/catalog.json&apos;;
import BACKEND_URL from &apos;../../env-config.js&apos;;
import reducer from &apos;./catalog&apos;;
import { LoadingStates } from &apos;../../utils/common&apos;;

const reducerState = {
  catalogData: [],
  loading: LoadingStates.CLEAN,
  filterText: &apos;&apos;,
  errorfetching: false
}

describe(&quot;actions&quot;, () =&gt; {
  const middlewares = [ thunk ];
  const mockStore = configureMockStore(middlewares);

  afterEach(() =&gt; {
    nock.cleanAll();
  })

  it(&quot;should create an action to request catalog&quot;, ()=&gt; {
    const expectedAction = {
      type: catalog.REQUEST
    }
    expect(catalog.request()).toEqual(expectedAction);
  });

  // async action
  // it(&quot;should create an action to receive catalog&quot;, ()=&gt; {
  //   nock(BACKEND_URL).get(&apos;/catalog&apos;).reply(200, catalogJSONData);
  //
  //   const expectedAction = [
  //     { type: catalog.REQUEST },
  //     { type: catalog.RECEIVE_SUCCESS, payload: catalogJSONData }
  //   ]
  //   const store = mockStore({catalogData: []});
  //
  //   return store.dispatch(catalog.fetchMicroservices)
  //     .then(() =&gt; {
  //       expect(store.getActions()).toEqual(expectedAction);
  //     })
  // });
  //
  // // async action
  // it(&quot;should create an action to handle errors while receiving catalog&quot;, () =&gt; {
  //   nock(BACKEND_URL).get(&apos;/catalog&apos;).reply(400, &quot;Error&quot;);
  //
  //   const expectedAction = [
  //     { type: catalog.REQUEST },
  //     { type: catalog.RECEIVE_ERROR }
  //   ]
  //   const store = mockStore({catalogData: []});
  //
  //   return store.dispatch(catalog.fetchMicroservices)
  //     .then(() =&gt; {
  //       expect(store.getActions()).toEqual(expectedAction);
  //     })
  // })
  //
  // // async action
  // it(&quot;should create an action to initialize the edit form&quot;, ()=&gt; {
  //   let id = &quot;58b201896a0d9170dbb7768e&quot;; // sample Id of microservice
  //   nock(BACKEND_URL).get(&apos;/catalog/&apos;+id).reply(200, catalogJSONData);
  //   const expectedAction = [{ type: catalog.INITIALIZE_EDIT_FORM_SUCCESS, payload: catalogJSONData }];
  //   const store = mockStore({catalogData: []});
  //
  //   return store.dispatch(catalog.initializeEditForm(id))
  //     .then(() =&gt; {
  //       expect(store.getActions()).toEqual(expectedAction);
  //     })
  // });
  //
  // // async action
  // it(&quot;should create an action to handle errors while receiving edit form contents&quot;, () =&gt; {
  //   let id = &quot;58b201896a0d9170dbb7768e&quot;; // sample Id of microservice
  //   nock(BACKEND_URL).get(&apos;/catalog/&apos;+id).reply(400, &quot;Error&quot;);
  //   const expectedAction = [{ type: catalog.INITIALIZE_EDIT_FORM_ERROR }];
  //   const store = mockStore({catalogData: []});
  //
  //   return store.dispatch(catalog.initializeEditForm(id))
  //     .then(() =&gt; {
  //       expect(store.getActions()).toEqual(expectedAction);
  //     })
  // })

  it(&quot;should create an action to filter data for search&quot;, ()=&gt; {
    const payload=&quot;searched text&quot;;
    const expectedAction = {
      type: catalog.FILTER_DATA,
      payload
    }
    expect(catalog.filterText(payload)).toEqual(expectedAction);
  });
})

describe(&quot;reducers&quot;, () =&gt; {
  it(&quot;should return the initial state&quot;, () =&gt; {
    expect(reducer(undefined, {})).toEqual({
      catalogData: [],
      loading: LoadingStates.CLEAN,
      filterText: &apos;&apos;,
      errorfetching: false
    })
  });

  it(&quot;should handle fetchMicroservices request calls&quot;, () =&gt; {
    expect(reducer({
      catalogData: [],
      loading: LoadingStates.CLEAN,
      filterText: &apos;&apos;,
      errorfetching: false
    }, {
      type:catalog.REQUEST
    })).toEqual({
      catalogData: [],
      loading: LoadingStates.LOADING,
      filterText: &apos;&apos;,
      errorfetching: false
    })
  });

  it(&quot;should handle fetchMicroservices receive reducer&quot;, () =&gt; {
    expect(reducer({
      catalogData: [],
      loading: LoadingStates.LOADING,
      filterText: &apos;&apos;,
      errorfetching: false
    }, {
      type:catalog.RECEIVE_SUCCESS,
      payload: catalogJSONData
    })).toEqual({
      catalogData: catalogJSONData._embedded.catalog.map(function(obj){
        return {
          id: obj._links.self.href.substring(obj._links.self.href.lastIndexOf(&quot;/&quot;)+1, obj._links.self.href.length),
          catalog: obj
        }
      }),
      filterText: &apos;&apos;,
      loading: LoadingStates.LOADED,
      errorfetching: false,
    })
  });

  it(&quot;should handle errors in receive call&quot;, () =&gt; {
    expect(reducer(reducerState, {
      type:catalog.RECEIVE_ERROR
    })).toEqual({
      catalogData: [],
      filterText: &apos;&apos;,
      loading: LoadingStates.LOADED,
      errorfetching: true,
    })
  });

  it(&quot;should handle initializeFormHandler reducer&quot;, () =&gt; {
    expect(reducer(reducerState, {
      type:catalog.INITIALIZE_EDIT_FORM_SUCCESS,
      payload: catalogJSONData
    })).toEqual({
      formData: catalogJSONData,
      errorfetching: false
    })
  });

  it(&quot;should handle initializeFormErrorHandler reducer&quot;, () =&gt; {
    expect(reducer(reducerState, {
      type:catalog.INITIALIZE_EDIT_FORM_ERROR
    })).toEqual({
      errorfetching: true
    })
  });

  it(&quot;should handle filterDataHandler reducer&quot;, () =&gt; {
    expect(reducer(reducerState, {
      type:catalog.FILTER_DATA,
      payload: catalogJSONData
    })).toEqual({
      catalogData: [],
      loading: LoadingStates.CLEAN,
      errorfetching: false,
      filterText: catalogJSONData
    })
  });
})
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.5.2)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
